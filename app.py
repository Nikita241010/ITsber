import re
import csv
import os
from typing import List, Dict
import requests
import json

def ai_ask():
  qwestion = "–≤—ã–¥–∞–π –±—É–¥—É—â–∏–µ 20 —Å–∞–º—ã—Ö –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö IT —Å–æ–±—ã—Ç–∏–π –≤ —Å–ø–±(–∏–ª–∏ –±–ª–∏–∑–∫–∏—Ö –≥–æ—Ä–æ–¥–∞—Ö) " \
            "–ø–æ —Ç–∏–ø—É –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π –≤ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–Ω–æ –±—ã—Ç—å"\
            "–∫–∞–∫ —Å–ª—É—à–∞—Ç–µ–ª–µ–º —Ç–∞–∫ –∏ —Å–ø–∏–∫–µ—Ä–æ–º, —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–π —Ç–æ–ª—å–∫–æ –æ —Ç–µ—Ö —Å–æ–±—ã—Ç–∏—è—Ö –æ –∫–æ—Ç–æ—Ä—ã—Ö " \
            "–∑–Ω–∞–µ—à—å —Ö–æ—Ç—è –±—ã 6 –∏–∑ 9 —Ñ–∞–∫—Ç–æ–≤(—à–∞–±–ª–æ–Ω –Ω–∏–∂–µ), –≥–æ–≤–æ—Ä–∏ —Å—É—Ö–æ, —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–∞, —Ñ–∞–∫—Ç—ã," \
            "—è —Ö–æ—á—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–≤–æ–π –æ—Ç–≤–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –µ–≥–æ –ø–∞—Ä—Å–∏—Ç –∏ –∑–∞–Ω–æ—Å–∏—Ç—å –≤ –±–∞–∑—É —Ç–∞–∫ —á—Ç–æ" \
            " –≤—Å—ë –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å—Ç—Ä–æ–≥–æ –ø–æ —à–∞–±–ª–æ–Ω—É,"\
            "–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:"\
            "–ù–∞–∑–≤–∞–Ω–∏–µ:"\
            "–î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è:"\
            "–ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è:"\
            "–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ: –ê –≤–æ—Ç –µ–≥–æ —Å—É—Ö–æ –Ω–µ –Ω–∞–¥–æ, –∑–∞–∏–Ω—Ç–µ—Ä–∏—Å—É–π –Ω–æ –Ω–µ –ø—Ä–∏–¥—É–º—ã–≤–∞–π"\
            "–§–æ—Ä–º–∞—Ç: –û–Ω–ª–∞–π–Ω\–æ—Ñ–ª–∞–π–Ω"\
            "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: (–µ—Å–ª–∏ –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏ –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏–ª–∏ –∏—Å—Ç–æ—Ä–∏–∏)"\
            "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏–∫–µ—Ä–æ–≤: (–µ—Å–ª–∏ –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏ –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏–ª–∏ –∏—Å—Ç–æ—Ä–∏–∏)"\
            "–£—á–∞—Å—Ç–∏–µ: –∫–∞–∫ —Å–ø–∏–∫–µ—Ä\—Å–ª—É—à–∞—Ç–µ–ª—å"

  response = requests.post(
    url="https://openrouter.ai/api/v1/chat/completions",
    headers={
      "Authorization": "Bearer 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",
      "Content-Type": "application/json",
      "HTTP-Referer": "<YOUR_SITE_URL>", # Optional. Site URL for rankings on openrouter.ai.
      "X-Title": "<YOUR_SITE_NAME>", # Optional. Site title for rankings on openrouter.ai.
    },
    data=json.dumps({
      "model": "openai/gpt-4o-mini-search-preview",
      "messages": [
          {
            "role": "user",
            "content": qwestion
          }
        ],
      "max_tokens": 10000,  # –£–≤–µ–ª–∏—á–∏–ª –ª–∏–º–∏—Ç –¥–ª—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
      "temperature": 0.8
    })
  )
  if response.status_code == 200:
      response_data = response.json()
      # –¢–µ–ø–µ—Ä—å –∏–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞
      message_content = response_data['choices'][0]['message']['content']
          
      return message_content


def parse_events(text: str) -> List[Dict[str, str]]:
    """
    –ü–∞—Ä—Å–∏—Ç —Ç–µ–∫—Å—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏.
    –ï—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –¥—É–±–ª–∏—Ä—É—é—â–∏–π—Å—è –Ω–æ–º–µ—Ä, –¥–æ–ø–æ–ª–Ω—è–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.
    """
    events = {}
    
    # –£–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ —Ä–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å—Ç—Ä–æ–∫–∏
    lines = [line.strip() for line in text.split('\n') if line.strip()]
    
    i = 0
    while i < len(lines):
        line = lines[i]
        
        # –ò—â–µ–º –Ω–∞—á–∞–ª–æ –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ —Å –Ω–æ–º–µ—Ä–æ–º (—Ñ–æ—Ä–º–∞—Ç "1. **–ù–∞–∑–≤–∞–Ω–∏–µ:**")
        block_match = re.match(r'^(\d+)\.\s*\*\*–ù–∞–∑–≤–∞–Ω–∏–µ:\*\*\s*(.+)', line)
        if block_match:
            event_num = block_match.group(1)
            event_name = block_match.group(2).strip()
            
            # –ï—Å–ª–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ —Å —Ç–∞–∫–∏–º –Ω–æ–º–µ—Ä–æ–º —É–∂–µ –µ—Å—Ç—å, –¥–æ–ø–æ–ª–Ω—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            if event_num in events:
                current_event = events[event_num]
                print(f"üîç –ù–∞–π–¥–µ–Ω –¥—É–±–ª–∏–∫–∞—Ç –±–ª–æ–∫–∞ {event_num}, –∏—â–µ–º –Ω–µ–¥–æ—Å—Ç–∞—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é...")
            else:
                # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ
                current_event = {
                    '–Ω–æ–º–µ—Ä': event_num,
                    '–Ω–∞–∑–≤–∞–Ω–∏–µ': event_name,
                    '–¥–∞—Ç–∞_–ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è': '',
                    '–º–µ—Å—Ç–æ_–ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è': '',
                    '–∫—Ä–∞—Ç–∫–æ–µ_–æ–ø–∏—Å–∞–Ω–∏–µ': '',
                    '—Ñ–æ—Ä–º–∞—Ç': '',
                    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤': '',
                    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Å–ø–∏–∫–µ—Ä–æ–≤': '',
                    '—É—á–∞—Å—Ç–∏–µ': ''
                }
                events[event_num] = current_event
            
            i += 1
            
            # –ß–∏—Ç–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏ –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–ª–æ–∫–∞ –∏–ª–∏ –∫–æ–Ω—Ü–∞
            while i < len(lines):
                next_line = lines[i]
                
                # –ï—Å–ª–∏ –Ω–∞—à–ª–∏ —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫, –ø—Ä–µ—Ä—ã–≤–∞–µ–º
                if re.match(r'^\d+\.\s*\*\*–ù–∞–∑–≤–∞–Ω–∏–µ:\*\*', next_line):
                    break
                
                # –ü–∞—Ä—Å–∏–º –ø–æ–ª—è, –Ω–æ –∑–∞–ø–æ–ª–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –ø—É—Å—Ç—ã–µ
                field_mappings = {
                    '–î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è:': '–¥–∞—Ç–∞_–ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è',
                    '–ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è:': '–º–µ—Å—Ç–æ_–ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è',
                    '–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:': '–∫—Ä–∞—Ç–∫–æ–µ_–æ–ø–∏—Å–∞–Ω–∏–µ',
                    '–§–æ—Ä–º–∞—Ç:': '—Ñ–æ—Ä–º–∞—Ç',
                    '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:': '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤',
                    '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏–∫–µ—Ä–æ–≤:': '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Å–ø–∏–∫–µ—Ä–æ–≤',
                    '–£—á–∞—Å—Ç–∏–µ:': '—É—á–∞—Å—Ç–∏–µ'
                }
                
                for field_pattern, field_name in field_mappings.items():
                    if next_line.startswith(field_pattern):
                        value = next_line.replace(field_pattern, '').strip()
                        # –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ –∏ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –ø—É—Å—Ç–æ–µ
                        if value and not current_event[field_name]:
                            current_event[field_name] = value
                            print(f"   ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: {field_name} = {value}")
                        elif value and current_event[field_name]:
                            print(f"   ‚è© –ü—Ä–æ–ø—É—â–µ–Ω–æ: {field_name} —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ")
                        break
                
                i += 1
        else:
            i += 1
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –Ω–æ–º–µ—Ä—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º
    sorted_events = sorted(events.values(), key=lambda x: int(x['–Ω–æ–º–µ—Ä']))
    return sorted_events

def analyze_missing_fields(events: List[Dict[str, str]]):
    """
    –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –ø–æ–ª—è—Ö.
    """
    print(f"\nüìä –ê–Ω–∞–ª–∏–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö:")
    
    field_names = [
        '–Ω–∞–∑–≤–∞–Ω–∏–µ', '–¥–∞—Ç–∞_–ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è', '–º–µ—Å—Ç–æ_–ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è', 
        '–∫—Ä–∞—Ç–∫–æ–µ_–æ–ø–∏—Å–∞–Ω–∏–µ', '—Ñ–æ—Ä–º–∞—Ç', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤', 
        '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Å–ø–∏–∫–µ—Ä–æ–≤', '—É—á–∞—Å—Ç–∏–µ'
    ]
    
    for event in events:
        missing_fields = []
        for field in field_names:
            if not event.get(field):
                missing_fields.append(field)
        
        if missing_fields:
            print(f"   –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ {event['–Ω–æ–º–µ—Ä']}: ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç - {', '.join(missing_fields)}")
        else:
            print(f"   –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ {event['–Ω–æ–º–µ—Ä']}: ‚úÖ –í—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã")

def save_to_csv(events: List[Dict[str, str]], filename: str = "events_database.csv"):
    """
    –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö –≤ CSV —Ñ–∞–π–ª.
    """
    if not events:
        print("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è.")
        return
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–ª—è –¥–ª—è CSV
    fieldnames = [
        '–Ω–æ–º–µ—Ä', 
        '–Ω–∞–∑–≤–∞–Ω–∏–µ', 
        '–¥–∞—Ç–∞_–ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è', 
        '–º–µ—Å—Ç–æ_–ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è', 
        '–∫—Ä–∞—Ç–∫–æ–µ_–æ–ø–∏—Å–∞–Ω–∏–µ', 
        '—Ñ–æ—Ä–º–∞—Ç', 
        '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤', 
        '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Å–ø–∏–∫–µ—Ä–æ–≤', 
        '—É—á–∞—Å—Ç–∏–µ'
    ]
    
    try:
        with open(filename, 'w', newline='', encoding='utf-8') as csvfile:
            writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
            
            # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            writer.writeheader()
            
            # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            for event in events:
                writer.writerow(event)
        
        # –ü–æ–ª—É—á–∞–µ–º –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
        absolute_path = os.path.abspath(filename)
        print(f"üíæ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª: {absolute_path}")
        print(f"üìà –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: {len(events)}")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ CSV: {e}")

def print_events(events: List[Dict[str, str]]):
    """–ö—Ä–∞—Å–∏–≤–æ –≤—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö."""
    print(f"\nüéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ ({len(events)} –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π):")
    for event in events:
        print(f"\n–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ {event['–Ω–æ–º–µ—Ä']}:")
        print(f"  –ù–∞–∑–≤–∞–Ω–∏–µ: {event['–Ω–∞–∑–≤–∞–Ω–∏–µ'] or '‚ùå –Ω–µ —É–∫–∞–∑–∞–Ω–æ'}")
        print(f"  –î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è: {event['–¥–∞—Ç–∞_–ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è'] or '‚ùå –Ω–µ —É–∫–∞–∑–∞–Ω–æ'}")
        print(f"  –ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è: {event['–º–µ—Å—Ç–æ_–ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è'] or '‚ùå –Ω–µ —É–∫–∞–∑–∞–Ω–æ'}")
        print(f"  –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ: {event['–∫—Ä–∞—Ç–∫–æ–µ_–æ–ø–∏—Å–∞–Ω–∏–µ'] or '‚ùå –Ω–µ —É–∫–∞–∑–∞–Ω–æ'}")
        print(f"  –§–æ—Ä–º–∞—Ç: {event['—Ñ–æ—Ä–º–∞—Ç'] or '‚ùå –Ω–µ —É–∫–∞–∑–∞–Ω–æ'}")
        print(f"  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: {event['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤'] or '‚ùå –Ω–µ —É–∫–∞–∑–∞–Ω–æ'}")
        print(f"  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏–∫–µ—Ä–æ–≤: {event['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Å–ø–∏–∫–µ—Ä–æ–≤'] or '‚ùå –Ω–µ —É–∫–∞–∑–∞–Ω–æ'}")
        print(f"  –£—á–∞—Å—Ç–∏–µ: {event['—É—á–∞—Å—Ç–∏–µ'] or '‚ùå –Ω–µ —É–∫–∞–∑–∞–Ω–æ'}")
        print("-" * 60)

def display_csv_preview(filename: str = "events_database.csv", num_rows: int = 5):
    """
    –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–≤—å—é CSV —Ñ–∞–π–ª–∞.
    """
    try:
        with open(filename, 'r', encoding='utf-8') as csvfile:
            reader = csv.reader(csvfile)
            print(f"\nüìã –ü—Ä–µ–≤—å—é CSV —Ñ–∞–π–ª–∞ ({num_rows} –ø–µ—Ä–≤—ã—Ö —Å—Ç—Ä–æ–∫):")
            for i, row in enumerate(reader):
                if i <= num_rows:
                    print(" | ".join(row))
                else:
                    break
    except FileNotFoundError:
        print(f"‚ùå –§–∞–π–ª {filename} –Ω–µ –Ω–∞–π–¥–µ–Ω.")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ CSV —Ñ–∞–π–ª–∞: {e}")

# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
if __name__ == "__main__":
    # –¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç —Å –¥—É–±–ª–∏—Ä—É—é—â–∏–º–∏—Å—è –∏ –Ω–µ–ø–æ–ª–Ω—ã–º–∏ –±–ª–æ–∫–∞–º–∏

    answer =  ai_ask()
    print(answer)
    test_text = answer
   
    print("üöÄ –ù–∞—á–∞–ª–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π...")
    events = parse_events(test_text)
    
    # –ê–Ω–∞–ª–∏–∑ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
    analyze_missing_fields(events)
    
    # –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    print_events(events)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ CSV
    save_to_csv(events)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é CSV
    display_csv_preview()
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    print(f"\nüìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
    print(f"   –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π: {len(events)}")
    print(f"   –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤: {os.path.abspath('.')}")
